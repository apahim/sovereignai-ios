<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Manual - SovereignAI</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: #1d1d1f;
            background: #fff;
            line-height: 1.7;
        }
        .container { max-width: 720px; margin: 0 auto; padding: 60px 24px; }
        h1 { font-size: 2em; font-weight: 700; margin-bottom: 4px; }
        .updated { color: #86868b; margin-bottom: 40px; font-size: 0.9em; }
        h2 { font-size: 1.15em; font-weight: 600; margin-top: 32px; margin-bottom: 8px; }
        p { color: #424245; margin-bottom: 12px; }
        ul { padding-left: 20px; margin-bottom: 12px; }
        li { color: #424245; margin-bottom: 4px; }
        a { color: #0066cc; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .back { margin-top: 48px; padding-top: 24px; border-top: 1px solid #e5e5e5; }
        footer { margin-top: 48px; color: #86868b; font-size: 0.85em; }
    </style>
</head>
<body>
    <div class="container">
        <h1>User Manual</h1>
        <p class="updated">SovereignAI for iOS</p>

        <h2>Getting Started</h2>
        <p>When you first open SovereignAI, you will be guided through a short onboarding flow:</p>
        <ul>
            <li><strong>Server URL</strong> &mdash; Enter the base URL of your OpenAI-compatible server (for example, <code>http://192.168.1.10:11434</code> for a local Ollama instance).</li>
            <li><strong>Authentication</strong> &mdash; Choose how the app should authenticate with your server (see Authentication Methods below).</li>
            <li><strong>Test Connection</strong> &mdash; Tap the test button to verify the app can reach your server and retrieve the list of available models.</li>
            <li><strong>Select a Model</strong> &mdash; Pick the model you want to use from the list returned by your server.</li>
        </ul>
        <p>Once setup is complete, you are taken to the chat screen and can start a conversation immediately.</p>

        <h2>Authentication Methods</h2>
        <p>SovereignAI supports four authentication options. Choose the one that matches your server configuration:</p>
        <ul>
            <li><strong>None</strong> &mdash; No credentials are sent. Use this for local servers that do not require authentication.</li>
            <li><strong>API Key Header</strong> &mdash; Sends an API key in a custom request header. You can configure the header name (defaults to <code>X-Api-Key</code>). The key is stored securely in the iOS Keychain.</li>
            <li><strong>Bearer Token</strong> &mdash; Sends a bearer token in the <code>Authorization</code> header. Enter your token during setup; it is stored in the iOS Keychain.</li>
            <li><strong>OpenID Connect (OIDC)</strong> &mdash; Uses the device authorization flow. The app displays a code and a URL; open the URL in a browser, enter the code, and sign in with your identity provider. Tokens are stored in the iOS Keychain and refreshed automatically.</li>
        </ul>

        <h2>Chatting</h2>
        <p>Type your message in the input field at the bottom of the screen and tap send. The assistant's response streams in token by token as it is generated.</p>
        <ul>
            <li><strong>Thinking indicator</strong> &mdash; While the model is generating a response, a shimmer animation is displayed. If the model outputs reasoning tokens (e.g. <code>&lt;think&gt;</code> blocks), the reasoning is shown in a collapsible "Reasoning" section you can expand to read.</li>
            <li><strong>Markdown rendering</strong> &mdash; Assistant responses are rendered with full Markdown support, including headings, bold, italic, strikethrough, lists, links, blockquotes, tables, and task lists.</li>
            <li><strong>Code blocks</strong> &mdash; Fenced code blocks are syntax-highlighted and include a copy button so you can quickly copy code to the clipboard.</li>
            <li><strong>LaTeX &amp; math</strong> &mdash; Mathematical expressions are rendered using Unicode symbols. Display math is supported with <code>\[...\]</code> and <code>$$...$$</code> delimiters; inline math uses <code>\(...\)</code>. Math blocks appear in a styled container with a copy button.</li>
            <li><strong>Tables</strong> &mdash; Markdown tables (pipe-delimited) are rendered as a horizontally scrollable grid with column headers and row dividers. A header bar displays a table icon and a copy button that exports the table data as tab-separated values (TSV) to the clipboard.</li>
            <li><strong>Blockquotes</strong> &mdash; Nested blockquotes are shown with left border indicators and progressively reduced opacity for each nesting level.</li>
            <li><strong>Task lists</strong> &mdash; Lines beginning with <code>- [ ]</code> or <code>- [x]</code> are displayed as checkbox items.</li>
        </ul>

        <h2>Message Actions</h2>
        <p>Long-press any message to open its context menu. The following actions are available:</p>
        <ul>
            <li><strong>Copy</strong> &mdash; Copy the message text to the clipboard.</li>
            <li><strong>Edit</strong> &mdash; Available on your own messages only. Edit the text and resend it; the conversation continues from the edited message. Edited messages are marked with an "(edited)" indicator.</li>
            <li><strong>Regenerate Response</strong> &mdash; Available on your own messages only. Ask the model to generate a new response.</li>
            <li><strong>Delete</strong> &mdash; Remove a single message from the conversation.</li>
            <li><strong>Delete &amp; Following</strong> &mdash; Remove the selected message and every message after it.</li>
        </ul>

        <h2>Tools</h2>
        <p>SovereignAI includes three built-in tools that the model can use during a conversation:</p>
        <ul>
            <li><strong>Web Search</strong> &mdash; Searches the web using DuckDuckGo. When the model decides a web search would help answer your question, it performs a search automatically and uses the results to inform its response.</li>
            <li><strong>URL Reading</strong> &mdash; Fetches and reads the content of a web page or PDF document. The model can use this to pull in information from a specific URL. When a PDF link is provided, the app downloads the document and extracts text page by page using iOS's built-in PDFKit framework. If the PDF contains only scanned images with no extractable text, the tool reports that. For unsupported content types (such as images or video), the tool returns a clear message instead of garbled data.</li>
            <li><strong>Image Search</strong> &mdash; Searches DuckDuckGo for images, diagrams, and charts. When the model needs visual content, it performs an image search automatically and displays the results as a scrollable thumbnail gallery below its response. Tap any thumbnail to open a detail view showing the full-size image, its title, pixel dimensions, and a link to the source page.</li>
        </ul>
        <p>All three tools are enabled by default. You can enable or disable them in Settings &gt; Tools. When a search tool is used, the sources appear as an expandable section below the assistant's message. Image search results appear as a scrollable row of thumbnails that can be tapped for a full-size view with a link to the source page.</p>

        <h2>Managing Chats</h2>
        <p>The session list shows all your conversations. Each session row displays color-coded label dots (up to five, with an overflow count if there are more) so you can see at a glance which labels are applied.</p>
        <ul>
            <li><strong>Create a new chat</strong> &mdash; Tap the new-chat button to start a fresh conversation.</li>
            <li><strong>Delete a chat</strong> &mdash; Swipe left on a session to reveal the delete action.</li>
            <li><strong>Session menu</strong> &mdash; Tap the ellipsis (&hellip;) button on a session row to open a menu where you can add a new label or remove existing labels directly from the session list.</li>
            <li><strong>Clear a chat</strong> &mdash; Open a conversation and tap the settings icon in the toolbar to access per-chat options, including clearing all messages from the current chat.</li>
            <li><strong>Search</strong> &mdash; Use the search bar to find chats by title, label, or message content. Results match across all conversations.</li>
        </ul>

        <h2>Exporting Chats</h2>
        <p>Swipe right on a session in the session list to reveal the export action. Choose a format:</p>
        <ul>
            <li><strong>Markdown</strong> &mdash; Exports the conversation as a <code>.md</code> file with proper formatting.</li>
            <li><strong>JSON</strong> &mdash; Exports the raw conversation data as a <code>.json</code> file.</li>
            <li><strong>Plain Text</strong> &mdash; Exports a simple text transcript.</li>
        </ul>
        <p>After choosing a format, the iOS share sheet opens so you can save the file, send it via AirDrop, or share it with any other app.</p>

        <h2>Labels</h2>
        <p>Labels let you organize your conversations with color-coded tags. Each label is automatically assigned a consistent color derived from its name, so the same label always appears in the same color.</p>

        <p><strong>Adding and removing labels.</strong> Open a conversation and tap the settings icon to access label management. From there you can type a new label name and add it, or remove any existing label. Labels from your other conversations are shown as suggestions so you can reuse them with a single tap. You can also add or remove labels directly from the session list using the ellipsis (&hellip;) menu on each session row.</p>

        <p><strong>Label bar.</strong> When a conversation has labels, they appear as a row of colored capsules at the top of the chat view. Tap a label capsule to open chat settings; long-press it to insert the label (prefixed with <code>#</code>) into the input field.</p>

        <p><strong>Cross-chat context with #.</strong> When you include a <code>#label</code> reference in a message (for example, <code>#work</code>), SovereignAI loads the conversations from all other chats that have that label and includes them as context in the request sent to the model. This lets the model draw on information from related conversations when answering. You can reference multiple labels in a single message. The referenced content is subject to the context window limit, so if the combined conversations are too large, only the most recent messages are included.</p>

        <p><strong>Autocomplete with #.</strong> While typing a message, type <code>#</code> followed by characters to see matching label suggestions above the input field. Tap a suggestion to insert it. This provides a quick way to add label references without having to remember exact label names.</p>

        <p><strong>Filtering by label.</strong> At the top of the session list, a horizontal bar shows all labels used across your conversations. Tap one or more labels to filter the list and show only conversations that have at least one of the selected labels.</p>

        <p><strong>Label dots.</strong> Each session in the list shows up to five small colored dots representing its labels. If a session has more than five labels, a count (e.g., &ldquo;+2&rdquo;) is displayed next to the dots.</p>

        <h2>Settings</h2>
        <p>Open Settings from the session list. Settings are organized into the following groups:</p>
        <ul>
            <li><strong>Server</strong> &mdash; Change your server URL, authentication method, or credentials. Test the connection at any time.</li>
            <li><strong>Model</strong> &mdash; Select a different model, set a custom system prompt, and adjust sampling parameters under Advanced Settings:
                <ul>
                    <li><em>Temperature</em> &mdash; Controls randomness. Lower values produce more focused responses; higher values produce more creative ones.</li>
                    <li><em>Context Window</em> &mdash; How much conversation history to include in each request.</li>
                    <li><em>Top-p</em> &mdash; Limits word choices to the most likely options.</li>
                    <li><em>Frequency Penalty</em> &mdash; Reduces repetition by discouraging the model from repeating the same phrases.</li>
                    <li><em>Presence Penalty</em> &mdash; Encourages the model to bring up new topics.</li>
                    <li><em>Max Tokens</em> &mdash; Limits the maximum length of the model's response.</li>
                    <li><em>Seed</em> &mdash; Set a fixed number for reproducible responses, or leave at zero for random.</li>
                </ul>
            </li>
            <li><strong>Tools</strong> &mdash; Enable or disable web search, URL reading, and image search. When web search is enabled, you can also adjust the maximum number of search results (1&ndash;10, defaults to 5).</li>
            <li><strong>System</strong> &mdash; View storage information, delete all chats, or reset the app to its default state (clears all settings, credentials, and conversations).</li>
        </ul>

        <h2>Appearance</h2>
        <p>SovereignAI supports both light and dark mode. The app automatically follows your device's system appearance setting.</p>

        <div class="back">
            <a href="index.html">&larr; Back to SovereignAI</a>
        </div>

        <footer>
            <p>&copy; 2026 Amador Pahim Segundo. All rights reserved.</p>
        </footer>
    </div>
</body>
</html>
